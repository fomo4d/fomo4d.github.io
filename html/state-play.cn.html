<state-play>
<script>
        /* Initializes Popovers so they only require 1 click
        with love -justo */
        $(function () {
            $('[data-toggle="popover"]').popover();
            $('.checkmark').popover({
                trigger: "hover"
            });
        })


        setTimeout(function() {
        $('.tutorialArrow').fadeOut('fast');
        }, 20000); // <-- time in milliseconds
</script>

    <!-- fomo    -->
    <!-- NOTE: Displays the current pot size in ETH as well as time left in current round -->
    <div class="blurryboy" if={!$this.gracePeriod}></div>
    <div class="blurryboydark" if={$this.gracePeriod}></div>

    <div class="jumbotron rounded-0 text-center text-light teaser-cover" if={!$this.roundHasPassed}>
        <!--
        <div class="grid-container" if={!$this.gracePeriod}>
            <div id="hdgraphics" class="grid-top"></div>
        </div> -->
        <div class="container">
            <h4 class="display-4 scammed" style="font-style: italic;" if={!$this.playerIsLeader && JUST.Cache.currentRound[8] && JUST.Cache.currentRound[8] !=  "0x0000000000000000000000000000000000000000000000000000000000000000"}>
            {JUST.Bridges.Browser.web3.utils.toAscii(JUST.Cache.currentRound[8])}正试图</h4>
            <h4 class="display-4 scammed" style="font-style: italic;" if={!$this.playerIsLeader && JUST.Cache.currentRound[8] && JUST.Cache.currentRound[8] ==  "0x0000000000000000000000000000000000000000000000000000000000000000"}>
            有人正试图</h4>
            <h1 class="display-1 scammed" if={!$this.playerIsLeader && !$this.gracePeriod}>卷款而逃</h1>
            <h1 class="display-1 scammed" if={$this.playerIsLeader && !$this.gracePeriod}>你就要走上人生巅峰了！</h1>
            <h1 class="display-1 scammed" if={!$this.playerIsLeader && $this.gracePeriod}>ICO阶段</h1>
            <h1 class="display-1 scammed" if={$this.playerIsLeader && $this.gracePeriod}>你正在投资ICO</h1>
            <h2 class="display-3" if={$this.gracePeriod}><span class="ethglitch titleglow">{BN(JUST.Cache.currentRound[0]).plus(JUST.Cache.currentRound[5]).div(1e18).toFixed(4)} <i class="fab fa-ethereum ethglow"></i></span></h2>
            <h2 class="display-3" if={!$this.gracePeriod}><span class="ethglitch titleglow">{BN(JUST.Cache.currentRound[5]).div(1e18).toFixed(4)} <i class="fab fa-ethereum ethglow"></i></span> <span class="headtimer">--</span></h2>
             <h3 if={$this.gracePeriod} class="display-5" style="margin-top:50px;">ICO将于<span class="headtimer" style="display:inline;font-size:inherit;">内结束</span></h3>

            <!-- <h5 class="display-5" if={!$this.playerIsLeader && !$this.gracePeriod}><a class="titlepopoutrightmini">You're</a> going to stop them, right?</h5> -->
            <!-- <h5 class="display-5" if={!$this.playerIsLeader && !$this.gracePeriod}>{memes.buyButtonMessagePlayer[Math.floor(memes.buyButtonMessagePlayer.length * Math.random()) - 1].replace(/\$player/g, JUST.Bridges.Browser.web3.utils.toAscii(JUST.Cache.currentRound[8]))}</h5>-->
            <h5 class="display-5" if={$this.playerIsLeader  && !$this.gracePeriod}>如果没有人再购买钥匙，你得到所有的ETH！</h5>
              <!--<a if={$this.gracePeriod} href="javascript:void(0)" class="buyOneTicket btn btn-lg btn-block btn-purp pulse marginb">Participate in the ICO</a> -->
              <h4 if={$this.gracePeriod} class="lead">ICO阶段: 休息1小时。投入的ETH将被返还； 等待本轮开始，购买<a class="titlepopoutrightmini">最早</a>并且<a class="titlepopoutrightmini">最便宜</a>的钥匙</b> </h4>


                <!-- Button Handling for Buy 1x More;  -->
                <!-- This button appears when the player in the lead has a vanity name  -->
                <a href="javascript:void(0)" if={!$this.playerIsLeader && !$this.gracePeriod && JUST.Cache.currentRound[8] !=  "0x0000000000000000000000000000000000000000000000000000000000000000"} class="buyOneTicket btn btn-lg btn-block btn-purp pulse marginb">
                    <div class=row>
                        <div class="col-sm-1.5 no-mobile" style="padding-left: 10px">
                         1x <i class="fas fa-key"></i>
                        </div>
                        <div class=col-sm-11>
                        <span style="margin-right: 1rem;margin-left: -1rem" class="only-mobile mobile-text">1x <i class="fas fa-key"></i></span>
                        {memes.buyButtonMessagePlayer[Math.floor(memes.buyButtonMessagePlayer.length * Math.random()) - 1].replace(/\$player/g, JUST.Bridges.Browser.web3.utils.toAscii(JUST.Cache.currentRound[8]))}
                        </div>
                    </div>
                </a>

                <!-- This button appears when the player in the lead does not have a vanity name  -->
                <a href="javascript:void(0)" if={!$this.playerIsLeader && !$this.gracePeriod && JUST.Cache.currentRound[8] ==  "0x0000000000000000000000000000000000000000000000000000000000000000"} class="buyOneTicket btn btn-lg btn-block btn-purp pulse marginb">
                <div class=row>
                    <div class="col-sm-1.5 no-mobile" style="padding-left: 10px">
                     1x <i class="fas fa-key"></i>
                    </div>
                    <div class=col-sm-11>
                    <span style="margin-right: 1rem;margin-left: -1rem" class="only-mobile mobile-text">1x <i class="fas fa-key"></i></span>
                    {memes.buyButtonMessageAnon[Math.floor(memes.buyButtonMessageAnon.length * Math.random()) - 1].replace(/\$player/g, JUST.Bridges.Browser.web3.utils.toAscii(JUST.Cache.currentRound[8]))}
                    </div>
                </div>
                </a>

        </div>
        <!--
        <div class="grid-container">
            <div class="grid-bottom"></div>
        </div>
        -->
    </div>


    <!-- So and So has EXIT SCAMMED -->
    <div class="jumbotron rounded-0 text-center text-light teaser-cover marginb" if={$this.roundHasPassed}>
    <div class="container">


    <!-- Grouped up into elements w/ conditionals per winner or not winning case -->
        <h1 class="display-1 scammed" if={$this.playerIsLeader}>你成功了！</h1>
        <h1 class="display-1 scammed" if={!$this.playerIsLeader}>你失败了</h1>


        <!-- Eth Amount -->
        <h2 class="display-3"><span class="ethglitch titleglow">{BN(JUST.Cache.currentRound[5]).div(1e18).toFixed(4)} <i class="fab fa-ethereum ethglow"></i></span> <span class="headtimer" if={!$this.playerIsLeader}>drained by <a href="javascript:void(0)">{(JUST.Cache.currentRound[8] && JUST.Cache.currentRound[8] !=  "0x0000000000000000000000000000000000000000000000000000000000000000" ? JUST.Bridges.Browser.web3.utils.toAscii(JUST.Cache.currentRound[8]) : JUST.Cache.currentRound[7].substr(0, 10).concat("..."))}</a>!</span></h2>

        <!-- Custom RNG winner text -->
        <h6 class="display-5 scammed" if={!$this.gracePeriod && $this.playerIsLeader}>你将得到大约50%，并平分剩余</h6>
        <h6 class="display-5 scammed" if={$this.gracePeriod && $this.playerIsLeader}>你得到了大约50%，并平分剩余</h6>
        <h6 class="display-5 scammed titlepopoutrightmini" if={$this.playerIsLeader}><i>{memes.exitScamTheft[Math.floor(memes.exitScamTheft.length * Math.random()) - 1]}</i></h6>

        <div style="position: relative;">
          <h3 class="display-5" style="margin-top:50px;">新奖池里有<strong>{BN(JUST.Cache.currentRound[5]).div(10).div(1e18).toFixed(5)}</strong>ETH，<span style="font-style: italic;"><a class="titlepopoutrightmini">你</a>想拿到这些，对吧？</span></h3>


         <!-- This button appears when an exit scam has finished, and a new ICO phase needs to start -->
        <a href="javascript:void(0)" class=" buyOneTicket btn btn-lg btn-block btn-purp pulse marginb">
            <div class=row>
                    <div class=col-sm-1.5 style="padding-left: 10px">
                     1x <i class="fas fa-key"></i>
                    </div>
                    <div class=col-sm-11>
                    开始游戏
                    </div>
            </div>
        </a>


        </div>
      </div>
    </div>
    </div>
    <!-- /fomo -->
    <div class="container" style="margin-top:-1rem;">
        <div class="row cta-ticket" style="margin-top:-5rem;">
            <div class="col">
                <div class="alert alert-purp pulse text-center text-light" role="alert">购买一个钥匙来开始ICO</div>
            </div>
        </div>
        <div class="row" if={$this.gracePeriod}>
            <div class="col-md-3 no-mobile">

            </div>
            <!-- biddings & vault -->
            <div class="col-sm">

                <ul class="nav nav-tabs tabs-border-adjust" id="buyTabs" role="tablist">
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link active" id="purchaseTab" data-toggle="tab" href="#purchaseArea" role="tab" aria-controls="purchaseArea" aria-selected="true">ICO</a>
                  </li>
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link" id="vaultTab" data-toggle="tab" href="#vaultArea" role="tab" aria-controls="vaultArea" aria-selected="false">金库</a>
                  </li>
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link" id="refTab" data-toggle="tab" href="#refArea" role="tab" aria-controls="refArea" aria-selected="false">邀请页</a>
                  </li>
                </ul>
                <div class="tab-content" id="buyArea">
                <!-- biddings -->
                <div class="tab-pane fade show active" id="purchaseArea" role="tabpanel" aria-labelledby="purchaseArea">
                    <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                        <div class="row">
                            <div class="col">
                                <p class="lead nomarginb">ICO</p>
                            </div>
                            <div class="col-auto">
                                <p class="text-right nomarginb tutorial">
                                    <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                    <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="juster maek fun text pls" data-content="{popover.ico}">
                                    <i class="far fa-question-circle"></i>
                                    </a>
                                </p>
                            </div>
                        </div>
                        <hr>
                        <!-- ICO Purchase -->
                        <div class="row">
                        <div class="col text-center">
                                <p class="small">你想来分一杯羹，对吧？</p>
                            </div>
                        </div>
                        <div class="row marginb">
                          <div class="col">
                            <div id="purchase" class="tab-pane fade show active" role="tabpanel">
                            <div class="row" id="purchase">
                              <div class="col">
                                <div class="input-group mb-3">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text">
                                      <i class="fab fa-ethereum"></i>
                                    </span>
                                  </div>
                                  <input type="text" id="ethToSpend" class="form-control text-center" value="0.01 ETH">
                                </div>
                              </div>
                            </div>
                            <div class="row" style="position: relative;">
                              <div class="col">
                                <button type="button" id="ethSpend" class="btn btn-block btn-purp btn-lg ticketProcess"><i class="fab fa-ethereum"></i>发送ETH</button>
                              </div>
                              <div class="col">
                                <button type="button" id="ethReinvest" class="btn btn-block btn-outline-purp btn-lg ticketProcess"><i class="fas fa-piggy-bank"></i>使用金库</button>
                              </div>
                            </div>
                          </div>
                          </div>
                        </div>
                        <hr>
                        <div class="row marginb">
                            <div class="col">
                                <p class="lead nomarginb">选择队伍</p>
                            </div>
                            <div class="col-auto">
                                <p class="text-right nomarginb tutorial">
                                <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                    <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Pick where the Eth Goes!" data-content="{popover.teamselect}"><i class="far fa-question-circle"></i></a></p>
                            </div>
                        </div>
                        <div class="row marginb distribution">
                            <div class="col">
                                <div class="row">
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="2" id="teamsnek">
                                            <img src="./img/tsnek.png" alt="">
                                            <h5>蛇队</h5>
                                            <p>互帮互助，团结致胜</p>
                                        </label>
                                        <p style="color:#2ecc71">++ 分红最多</p>
                                    </div>
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="0" id="teamwhale">
                                            <img src="./img/twhale.png" alt="">
                                            <h5>鲸队</h5>
                                            <p>利用他人，鼓动贪婪</p>
                                        </label>
                                        <p style="color:#2ecc71">++ 进入奖池最多</p>
                                    </div>
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="3" id="teambull">
                                            <img src="./img/tbull.png" alt="">
                                            <h5>牛队</h5>
                                            <p>持续向上，永不停歇</p>
                                        </label>
                                        <p style="color:#2ecc71">+ 平衡分配</p>
                                    </div>
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="1" id="teambear">
                                            <img src="./img/tbear.png" alt="">
                                            <h5>熊队</h5>
                                            <p>万事由己，单打独斗。</p>
                                        </label>
                                        <p style="color:#2ecc71">++ 进入本轮最多</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <div class="chart"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    <!--<p class="small text-center">Your purchase will extend the game by a total of <span class="extender">NaN</span> Minutes.</p> -->
                    </div>
                </div>
                <!-- /biddings -->
                <!-- vault -->
                <div class="tab-pane fade" id="vaultArea" role="tabpanel" aria-labelledby="vaultArea">
                    <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                        <div class="row">
                          <div class="col">
                            <p class="lead nomarginb">金库</p>
                          </div>
                          <div class="col-auto">
                            <p class="text-right nomarginb tutorial">
                                <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                            <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="个人金库" data-content="{popover.vault}">
                            <i class="far fa-question-circle"></i>
                            </a>
                          </div>
                        </div>
                        <hr>
                        <div class="jumbotron jumbotron-adjust teamscore">
                        <!--  <div class="row">
                            <div class="col">
                              <p class="lead">Winning Pot (Unused)</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[0]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div> -->
                          <div class="row">
                            <div class="col">
                              <p class="lead">成功夺宝</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[0]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <p class="lead">邀请分红</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div>
                          <hr>
                          <div class="row">
                            <div class="col">
                              <p class="lead">总体收益</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right glow">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                              <p class="text-right">&#8793; {BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).multipliedBy(JUST.Cache.fiatRatios.USD).toFixed(5)} USDT</p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                                <p class="text-right nomarginb"><button href="" class="btn btn-outline-purp btn-block" id="withdrawEarnings"><i class="fas fa-hand-holding-heart"></i> Withdraw</button></p>
                            </div>
                          </div>
                        </div>
                    </div>
                </div>
                <!-- /vault -->

                <!-- vanity -->
                <div class="tab-pane fade" id="refArea" role="tabpanel" aria-labelledby="refArea">
                    <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                        <div class="row">
                          <div class="col">
                            <p class="lead nomarginb">邀请系统</p>
                          </div>
                          <div class="col-auto">
                            <p class="text-right nomarginb tutorial">
                                <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                            <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Probably Bribery" data-content="{popover.referral}">
                            <i class="far fa-question-circle"></i>
                            </a>
                          </div>
                        </div>
                        <hr>
                        <div class="jumbotron jumbotron-adjust teamscore">
                            <div class="row" if={!$this.isCEO}>
                                <div class="col">
                                <p>注册一个名字，永久解锁邀请系统</p>
                                </div>
                            </div>
                            <div class="row" if={!$this.isCEO}>
                                <div class="col">
                                    <button href="" class="btn btn-purp btn-block buyceo"><i class="fas fa-check"></i>注册名字解锁邀请与排行榜</button>
                                </div>
                              </div>
                            <div class="row" if={$this.isCEO}>
                                <div class="col">
                                    <p class="font-weight-light">邀请好友加入游戏，获得他们所有支出10% ETH的分红。</p>
                                </div>
                            </div>
                            <div class="row" if={$this.isCEO}>
                                <div class="col text-center">
                                    <p>
                                        <span>钱包地址邀请</span><br>
                                        <span class="small" id="ceolink">{$this.myLink}</span><br>
                                        <button class="btn btn-outline-purp" id="copyCeoLink" data-clipboard-target="#ceolink"}>
                                        <i class="fas fa-paste"></i> 拷贝</button>
                                    </p>
                                    <p>
                                        <span>匿名邀请</span><br>
                                        <span class="small" id="ceolinkid">{$this.myLinkid}</span><br>
                                        <button class="btn btn-outline-purp" id="copyCeoLink" data-clipboard-target="#ceolinkid"}>
                                        <i class="fas fa-paste"></i> 拷贝</button>

                                    </p>
                                    <p>
                                        <span>用户名邀请</span><br>
                                        <span class="small" id="ceolinkvanity">{$this.myLinkName}</span><br>
                                        <button class="btn btn-outline-purp" id="copyCeoLink" data-clipboard-target="#ceolinkvanity"}>
                                        <i class="fas fa-paste"></i> 拷贝</button>
                                    </p>
                                </div>
                            </div>
                            <div class="row" if={$this.isCEO}>
                                <div class="col">
                                    <button href="" class="btn btn-outline-purp btn-block buyceo"><i class="fas fa-check"></i> 注册新游戏</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <!-- /vanity -->
        <div class="col-md-3 no-mobile">

        </div>
        </div>
        <div class="row" if={!$this.gracePeriod}>
            <!-- biddings & vault -->
            <div class="col-sm">

                <ul class="nav nav-tabs tabs-border-adjust" id="buyTabs" role="tablist">
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link active" id="purchaseTab" data-toggle="tab" href="#purchaseArea" role="tab" aria-controls="purchaseArea" aria-selected="true">购买</a>
                  </li>
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link" id="vaultTab" data-toggle="tab" href="#vaultArea" role="tab" aria-controls="vaultArea" aria-selected="false">金库</a>
                  </li>
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link" id="refTab" data-toggle="tab" href="#refArea" role="tab" aria-controls="refArea" aria-selected="false">邀请</a>
                  </li>
                </ul>
                <div class="tab-content" id="buyArea">
                <!-- biddings -->
                <div class="tab-pane fade show active" id="purchaseArea" role="tabpanel" aria-labelledby="purchaseArea">
                    <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                        <div class="row">
                            <div class="col" if={!$this.roundHasPassed}>
                                <p class="lead nomarginb">钥匙</p>
                            </div>
                            <div class="col" if={$this.roundHasPassed}>
                                <p class="lead nomarginb">Pre-ICO阶段</p>
                            </div>
                            <div class="col-auto">
                                <p class="text-right nomarginb tutorial">
                                    <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                    <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Exit Scams and You!" data-content="{popover.purchase}">
                                    <i class="far fa-question-circle"></i>
                                    </a>
                                </p>
                            </div>
                        </div>
                        <hr>
                        <!-- Ticket Purchase -->
                        <!-- NOTE: Ticket purchase should update the ETH value to how much is actually going to be paid by the player, as well as update the time limit extension (NaN Minutes) accordingly -->
                        <div class="row">
                          <div class="col">
                            <div id="purchase" class="tab-pane fade show active" role="tabpanel">
                                <p class="font-weight-light small" if={!$this.roundHasPassed} id ="airdrop_chance">花费0.1ETH以上，你将有{JUST.Cache.airdropTracker}%机会立刻获得部分{JUST.Cache.airdropPot}ETH空投池!</p>
                            <p class="text-center" if={$this.roundHasPassed}>发送ETH开始下一轮</p>
                            <div class="row" id="purchase" if={!$this.roundHasPassed}>
                              <div class="col">
                                <div class="input-group mb-3">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text">
                                      <i class="fas fa-key"></i>
                                    </span>
                                  </div>
                                  <input type="text" id="tixToBuy" class="form-control text-center" value="1把钥匙">
                                  <div class="input-group-append">
                                    <span class="input-group-text" id="tixQuotation">
                                      @ {BN(JUST.Cache.currentRound[3]).div(1e18).toFixed(8)} ETH
                                    </span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row" if={$this.roundHasPassed}>
                                <div class="col">
                                    <div id="purchase" class="tab-pane fade show active" role="tabpanel">
                                        <div class="row" id="purchase">
                                          <div class="col">
                                            <div class="input-group mb-3">
                                              <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                  <i class="fab fa-ethereum"></i>
                                                </span>
                                              </div>
                                              <input type="text" id="ethToSpend" class="form-control text-center" value="0.01 ETH">
                                            </div>
                                          </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row marginb" if={!$this.roundHasPassed}>
                              <div class="col">
                                <div class="btn-group d-flex" role="group">
                                  <button id="addOne" class="btn btn-outline-yel w-100 increment">+ 1把钥匙</button>
                                  <button id="addTwo" class="btn btn-outline-yel w-100 increment">+ 2把钥匙</button>
                                  <button id="addFive" class="btn btn-outline-yel w-40 increment">+ 5把</button>
                                  <button id="addTen" class="btn btn-outline-yel w-30 increment">+ 10把</button>
                                  <button id="addHundred" class="btn btn-outline-yel w-30 increment">+ 100把</button>
                                </div>
                              </div>
                            </div>
                            <div class="row" style="position: relative;"  if={!$this.roundHasPassed}>
                              <div class="col">
                                <button type="button" id="tixBuy" class="btn btn-block btn-purp btn-lg ticketProcess"><i class="fab fa-ethereum"></i> ETH支付</button>
                              </div>
                              <div class="col">
                                <button type="button" id="tixReinvest" class="btn btn-block btn-outline-purp btn-lg ticketProcess"><i class="fas fa-piggy-bank"></i> 使用金库</button>
                              </div>
                            </div>
                            <div class="row" style="position: relative;"  if={$this.roundHasPassed}>
                              <div class="col">
                                <button type="button" id="ethSpend" class="btn btn-block btn-purp btn-lg ticketProcess"><i class="fab fa-ethereum"></i> ETH支付</button>
                              </div>
                              <div class="col">
                                <button type="button" id="ethReinvest" class="btn btn-block btn-outline-purp btn-lg ticketProcess"><i class="fas fa-piggy-bank"></i> 使用金库</button>
                              </div>
                            </div>
                                <p class="small text-center" if={!$this.gracePeriod}>支付ETH，或使用金库余额。</p>
                          </div>
                          </div>
                        </div>
                        <!-- Team Selector -->
                        <hr>
                        <div class="row marginb">
                            <div class="col">
                                <p class="lead nomarginb">选择队伍</p>
                            </div>
                            <div class="col-auto">
                                <p class="text-right nomarginb tutorial">
                                <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                    <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Pick where the Eth Goes!" data-content="{popover.teamselect}"><i class="far fa-question-circle"></i></a></p>
                            </div>
                        </div>
                        <div class="row marginb distribution">
                            <div class="col">
                                <div class="row">
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="2" id="teamsnek">
                                            <img src="./img/tsnek.png" alt="">
                                            <h5>蛇队</h5>
                                            <p>互帮互助，团结致胜。</p>
                                        </label>
                                        <div>
                                        <p style="color:#2ecc71">++ 分红最多</p>
                                        </div>
                                    </div>
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="0" id="teamwhale">
                                            <img src="./img/twhale.png" alt="">
                                            <h5>鲸队</h5>
                                            <p>利用他人，鼓动贪婪。</p>
                                        </label>
                                        <p style="color:#2ecc71">++ 进入奖池最多</p>
                                    </div>
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="3" id="teambull">
                                            <img src="./img/tbull.png" alt="">
                                            <h5>牛队</h5>
                                            <p>持续向上，永不停歇。</p>
                                        </label>
                                        <p style="color:#2ecc71">+ 平衡分配</p>

                                    </div>
                                    <div class="col-3 team">
                                        <label class="teamselector">
                                            <input class="form-check-input form-radio teamsave" type="radio" autocomplete="off" name="teamselect" value="1" id="teambear">
                                            <img src="./img/tbear.png" alt="">
                                            <h5>熊队</h5>
                                            <p>万事由己，单打独斗。</p>
                                        </label>
                                        <p style="color:#2ecc71">++ 进入本轮最多</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <div class="chart"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /Team Selector -->
                    <!--<p class="small text-center">Your purchase will extend the game by a total of <span class="extender">NaN</span> Minutes.</p> -->
                    </div>
                </div>
                <!-- /biddings -->
                <!-- vault -->
                <div class="tab-pane fade" id="vaultArea" role="tabpanel" aria-labelledby="vaultArea">
                    <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                        <div class="row">
                          <div class="col">
                            <p class="lead nomarginb">金库</p>
                          </div>
                          <div class="col-auto">
                            <p class="text-right nomarginb tutorial">
                                <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                            <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Vault 77: Where you keep the puppets" data-content="{popover.vault}">
                            <i class="far fa-question-circle"></i>
                            </a>
                          </div>
                        </div>
                        <hr>
                        <div class="jumbotron jumbotron-adjust teamscore">
                        <!--  <div class="row">
                            <div class="col">
                              <p class="lead">Winning Pot (Unused)</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[0]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div> -->

                            <div class="row">
                            <div class="col">
                              <p class="lead">锁定金额</p>
                            </div>
                            <div class="col">
                            <!--
                              <p class="h6 text-right" style="font-size: .9rem">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn) ? ((BN(JUST.Cache.currentPlayer.Round[2]).div(1e18).toFixed(1) : BN(0).toFixed(4)).div(BN(JUST.Cache.currentRound[2]).div(1e18).toFixed(0))).mul((BN(JUST.Cache.currentRound[5]).div(1e18).toFixed(4).div(100)).mul(30))}</p>
                              -->
                              <p class="h3 text-right" label=poteth>{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn) ? (((BN(JUST.Cache.currentRound[5]).div(100).multipliedBy(30)).div(BN(JUST.Cache.currentRound[2]))).multipliedBy(BN(JUST.Cache.currentPlayer.Round[2])).div(1e18).toFixed(4)) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div>

                          <div class="row">
                            <div class="col">
                              <p class="lead">成功夺宝</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[0]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div>

                          <div class="row">
                            <div class="col">
                              <p class="lead">邀请分红</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                            </div>
                          </div>

                          <hr>
                          <div class="row">
                            <div class="col">
                              <p class="lead">总体收益</p>
                            </div>
                            <div class="col">
                              <p class="h3 text-right glow">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Vaults) ? BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).toFixed(4) : BN(0).toFixed(4)} ETH</p>
                              <p class="text-right">&#8793; {BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).multipliedBy(JUST.Cache.fiatRatios.USD).toFixed(5)} USDT</p>
                            </div>
                          </div>

                          <div class="row">
                            <div class="col">
                                <p class="text-right nomarginb"><button href="" class="btn btn-outline-purp btn-block" id="withdrawEarnings"><i class="fas fa-hand-holding-heart"></i> 提款</button></p>
                            </div>
                          </div>
                        </div>
                    </div>
                </div>
                <!-- /vault -->

                <!-- vanity -->
                <div class="tab-pane fade" id="refArea" role="tabpanel" aria-labelledby="refArea">
                    <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                        <div class="row">
                          <div class="col">
                            <p class="lead nomarginb">邀请页</p>
                          </div>
                          <div class="col-auto">
                            <p class="text-right nomarginb tutorial">
                                <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                            <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Probably Bribery" data-content="{popover.referral}">
                            <i class="far fa-question-circle"></i>
                            </a>
                          </div>
                        </div>
                        <hr>
                        <div class="jumbotron jumbotron-adjust teamscore">
                            <div class="row" if={!$this.isCEO}>
                                <div class="col">
                                <p>注册用户名，永久解锁邀请系统。</p>
                                </div>
                            </div>
                            <div class="row" if={!$this.isCEO}>
                                <div class="col">
                                    <button href="" class="btn btn-purp btn-block buyceo"><i class="fas fa-check"></i> 注册一个昵称，永久解锁排行榜与邀请系统。</button>
                                </div>
                              </div>
                            <div class="row" if={$this.isCEO}>
                                <div class="col">
                                    <p class="font-weight-light">邀请好友加入游戏，获得他们所有支出ETH 10%的分红。</p>
                                </div>
                            </div>
                            <div class="row" if={$this.isCEO}>
                                <div class="col text-center">
                                    <p>
                                        <span>钱包邀请</span><br>
                                        <span class="small" id="ceolink">{$this.myLink}</span><br>
                                        <button class="btn btn-outline-purp" id="copyCeoLink" data-clipboard-target="#ceolink"}>
                                        <i class="fas fa-paste"></i> 拷贝</button>
                                    </p>
                                    <p>
                                        <span>匿名邀请</span><br>
                                        <span class="small" id="ceolinkid">{$this.myLinkid}</span><br>
                                        <button class="btn btn-outline-purp" id="copyCeoLink" data-clipboard-target="#ceolinkid"}>
                                        <i class="fas fa-paste"></i> 拷贝</button>

                                    </p>
                                    <p>
                                        <span>昵称邀请</span><br>
                                        <span class="small" id="ceolinkvanity">{$this.myLinkName}</span><br>
                                        <button class="btn btn-outline-purp" id="copyCeoLink" data-clipboard-target="#ceolinkvanity"}>
                                        <i class="fas fa-paste"></i> 拷贝</button>
                                    </p>
                                </div>
                            </div>
                            <div class="row" if={$this.isCEO}>
                                <div class="col">
                                    <button href="" class="btn btn-outline-purp btn-block buyceo"><i class="fas fa-check"></i> 注册新昵称</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /vanity -->
                </div>
            </div>

            <!-- stat tabs -->
            <div class="col-sm">
                <!-- tabs -->
                <ul class="nav nav-tabs tabs-border-adjust" id="statTabs" role="tablist">
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link active" id="potTab" data-toggle="tab" href="#potArea" role="tab" aria-controls="potArea" aria-selected="true">回合</a>
                  </li>
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link" id="teamTab" data-toggle="tab" href="#teamArea" role="tab" aria-controls="teamArea" aria-selected="false">战队</a>
                  </li>
                  <li class="nav-item tab-item">
                    <a class="nav-link tab-link" id="statsTab" data-toggle="tab" href="#statsArea" role="tab" aria-controls="statsArea" aria-selected="false">数据</a>
                  </li>
                </ul>

                <!-- tabbable areas -->
                <div class="tab-content" id="statArea">
                    <!-- current pot -->
                    <div class="tab-pane fade show active" id="potArea" role="tabpanel" aria-labelledby="potArea">

                        <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                            <div class="row">
                              <div class="col">
                                <p class="lead nomarginb">第{JUST.Cache.currentRound[1]}轮</p>
                              </div>
                              <div class="col-auto">
                                <p class="text-right nomarginb tutorial">
                                    <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Important Box:" data-content="{popover.game}">
                                <i class="far fa-question-circle"></i>
                                </a>
                              </div>
                            </div>
                            <hr>
                            <div class="row nomarginb margin-top" if={!$this.roundHasPassed}>
                                <div class="col">
                                    <!-- NOTE: Time limit counter -->
                                    <p class="h2 text-center" if={this.playerIsLeader}>成功夺宝剩余时间<br><span class="glow boxtimer"></span></p>
                                    <p class="h2 text-center" if={!this.playerIsLeader}>奖池清空剩余时间<br><span class="glow boxtimer"></span></p>
                                </div>
                            </div>
                            <div class="row nomarginb margin-top" if={$this.roundHasPassed}>
                                <div class="col" style="position: relative;">
                                    <!-- NOTE: Time limit counter -->
                                    <p class="h6 text-center">ETH正在等你来拿，<a class="titlepopoutrightmini">你</a>还在等什么？</p>
                                      <a style="margin-bottom:40px;" href="javascript:void(0)" class="buyOneTicket btn btn-lg btn-block btn-purp pulse"> 购买一把<i class="fas fa-key"></i>，占据先机！</a>
                                </div>
                            </div>
                            <div class="row marginb" if={!$this.roundHasPassed}>
                                <div class="col">
                                    <div class="progress">
                                        <div class="progress-bar boxglow" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="jumbotron jumbotron-adjust teamscore">
                                <div class="row nomarginb">
                                    <div class="col-auto">
                                        <p class="h4" if={!$this.roundHasPassed}>本轮奖金</p>
                                        <p class="h4" if={$this.roundHasPassed}>等待领取</p>
                                    </div>
                                    <div class="col">
                                        <!-- NOTE: Display of current pot size as well as converted USDT value -->
                                        <p class="h2 text-right glow ethglitch" if={!$this.roundHasPassed}>{BN(JUST.Cache.currentRound[5]).div(1e18).toFormat(2)} <i class="fab fa-ethereum ethglow"></i></p>
                                        <p class="h2 text-right glow ethglitch" if={$this.roundHasPassed}>{BN(JUST.Cache.currentRound[5]).div(1e19).toFormat(5)} <i class="fab fa-ethereum ethglow"></i></p>
                                    </div>
                                </div>
                                <div class="row marginb">
                                    <div class="col text-right"  if={!$this.roundHasPassed}>&#8793; {BN(JUST.Cache.currentRound[5]).div(1e18).multipliedBy(JUST.Cache.fiatRatios.USD).toFormat(5)} USDT</div>
                                    <div class="col text-right"  if={$this.roundHasPassed}>&#8793; {BN(JUST.Cache.currentRound[5]).div(1e19).multipliedBy(JUST.Cache.fiatRatios.USD).toFormat(5)} USDT</div>
                                </div>
                                <div class="row nomarginb"  if={!$this.roundHasPassed}>
                                    <div class="col">
                                      <p class="h4">持有钥匙</p>
                                    </div>
                                    <div class="col">
                                      <p class="h2 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn) ? BN(JUST.Cache.currentPlayer.Round[2]).div(1e18).toFormat(1) : BN(0).toFormat(4)} <i class="fas fa-key"></i></p>
                                    </div>
                                </div>
                                  <div class="row marginb" if={!$this.roundHasPassed}>
                                    <div class="col text-right">共有{BN(JUST.Cache.currentRound[2]).div(1e18).toFormat(0)}把钥匙</div>
                                  </div>
                                  <div class="row nomarginb">
                                    <div class="col">
                                      <p class="h4">获得收益</p>
                                    </div>
                                    <div class="col">
                                      <p class="h2 text-right">{(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn) ? BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).toFormat(4) : BN(0).toFormat(5)} <i class="fab fa-ethereum"></i></p>
                                    </div>
                                </div>
                                <div class="row marginb">
                                    <div class="col text-right">
                                        &#8793; {BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2]).div(1e18).multipliedBy(JUST.Cache.fiatRatios.USD).toFormat(5)} USDT
                                    </div>
                                  </div>
                            </div>
                        </div>
                    </div>
                    <!-- /current pot -->

                    <!-- teams -->
                    <div class="tab-pane fade" id="teamArea" role="tabpanel" aria-labelledby="teamArea">
                        <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                            <div class="row">
                                  <div class="col">
                                    <p class="lead nomarginb">战队</p>
                                  </div>
                                  <div class="col-auto">
                                    <p class="text-right nomarginb tutorial">
                                    <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                    <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Pick a team, get angry at those not on your team." data-content="{popover.teams}">
                                        <i class="far fa-question-circle"></i>
                                    </a>
                                  </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <div class="jumbotron jumbotron-adjust text-center teamscore">
                                        <p class="lead">鲸队</p>
                                        <img src="./img/twhale.png" width="25%"</img>
                                        <hr>
                                        <p class="glow-yel">{BN(JUST.Cache.currentRound[9]).div(1e18).toFormat(4)} ETH</p>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="jumbotron jumbotron-adjust text-center    teamscore">
                                        <p class="lead">熊队</p>
                                        <img src="./img/tbear.png" width="25%"</img>
                                        <hr>
                                        <p class="glow-yel">{BN(JUST.Cache.currentRound[10]).div(1e18).toFormat(4)} ETH</p>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <div class="jumbotron jumbotron-adjust text-center    teamscore">
                                        <p class="lead">牛队</p>
                                        <img src="./img/tbull.png" width="25%"</img>
                                        <hr>
                                        <p class="glow-yel">{BN(JUST.Cache.currentRound[12]).div(1e18).toFormat(4)} ETH </p>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="jumbotron jumbotron-adjust text-center    teamscore">
                                        <p class="lead">蛇队</p>
                                        <img src="./img/tsnek.png" width="25%"</img>
                                        <hr>
                                        <p class="glow-yel">{BN(JUST.Cache.currentRound[11]).div(1e18).toFormat(4)} ETH </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /teams -->

                    <!-- recent players -->

                    <!-- Stats page -->
                    <!-- Stats page -->

                    <div class="tab-pane fade" id="statsArea" role="tabpanel" aria-labelledby="statsArea">

                        <div class="jumbotron jumbotron-adjust text-light bg-dark jumboshade tab-rounded">
                            <div class="row">
                              <div class="col">
                                <p class="lead nomarginb">第{JUST.Cache.currentRound[1]}轮(本轮)数据</p>
                              </div>
                              <div class="col-auto">
                                <p class="text-right nomarginb tutorial">
                                    <i class="fas fa-arrow-right pulsetutorial tutorialArrow"></i>
                                <a tabindex="0" type="button" class="qbtn" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-placement="bottom" title="Important Box:" data-content="{popover.stats}">
                                <i class="far fa-question-circle"></i>
                                </a>
                              </div>
                            </div>
                            <hr>
                            <div class="jumbotron jumbotron-adjust teamscore">

                                <div class="row nomarginb">
                                    <div class="col-auto">
                                        <p class="h4" >累计投入:</p>
                                    </div>
                                    <div class="col">
                                        <p class="h2 text-right glow ethglitch">{((BN(JUST.Cache.currentRound[9])).plus(BN(JUST.Cache.currentRound[10])).plus(BN(JUST.Cache.currentRound[11])).plus(BN(JUST.Cache.currentRound[12]))).div(1e18).toFormat(3)} <i class="fab fa-ethereum ethglow"></i></p>
                                    </div>
                                </div>
                                <div class="row marginb">
                                    <div class="col text-right">&#8793; {(((BN(JUST.Cache.currentRound[9])).plus(BN(JUST.Cache.currentRound[10])).plus(BN(JUST.Cache.currentRound[11])).plus(BN(JUST.Cache.currentRound[12])))).div(1e18).multipliedBy(JUST.Cache.fiatRatios.USD).toFormat(2)} USDT</div>
                                </div>

                                <div class="row nomarginb">
                                    <div class="col-auto">
                                        <p class="h4" >分配收益:</p>
                                    </div>
                                    <div class="col">
                                        <p class="h2 text-right glow ethglitch">{((BN(JUST.Cache.currentRound[9])).plus(BN(JUST.Cache.currentRound[10])).plus(BN(JUST.Cache.currentRound[11])).plus(BN(JUST.Cache.currentRound[12])).minus(BN(JUST.Cache.currentRound[5]))).div(1e18).toFormat(3)} <i class="fab fa-ethereum ethglow"></i></p>
                                    </div>
                                </div>
                                <div class="row marginb">
                                    <div class="col text-right">&#8793;{((BN(JUST.Cache.currentRound[9])).plus(BN(JUST.Cache.currentRound[10])).plus(BN(JUST.Cache.currentRound[11])).plus(BN(JUST.Cache.currentRound[12])).minus(BN(JUST.Cache.currentRound[5]))).multipliedBy(JUST.Cache.fiatRatios.USD).div(1e18).toFormat(2)} USDT </div>
                                </div>


                                <div class="row nomarginb">
                                    <div class="col-auto">
                                        <p class="h4" >已买时间</p>
                                    </div>
                                    <div class="col">
                                        <p class="h2 text-right glow ethglitch">{((BN(JUST.Cache.currentRound[2])).div(1e18).multipliedBy(30000)).div(31536000000).toFixed(2)}年</p>
                                    </div>
                                </div>
                                <div class="row marginb">
                                    <div class="col text-right"> {((BN(JUST.Cache.currentRound[2])).div(1e18).multipliedBy(30)).toFormat(0)}秒</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /tabbable area -->
            </div>
            <!-- /stat tabs -->
        </div>
        </div>
    </div>
    <!-- modal popup -->
    <div class="modal fade" id="gameover" tabindex="-1" role="dialog" aria-labelledby="gameoverTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content bg-dark text-light">
                <div class="modal-header">
                    <h5 class="modal-title" id="gameoverTitle">Modal Title</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                </div>
            </div>
        </div>
    </div>

    <!-- If something breaks delet this script justo made; -->
    <script>
    // Contain the popover within the body NOT the element it was called in.
        $('[data-toggle="popover"]').popover({
            container: 'body'
        });

        $this = this
        $this.refresher = _.debounce(async () => {
            JUST.Cache.currentRound = await JUST.Bridges.Browser.contracts.Fomo3D.read("getCurrentRoundInfo")
            clearInterval(window.globalTimerObject)
            $this.update()
        }, 500)

        async function assemble() {
            $this.roundHasPassed = Math.floor( JUST.date().getTime() / 1000) > JUST.Cache.currentRound[3]
            $this.playerIsLeader = JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && Math.floor(parseInt(JUST.Cache.currentRound[6]/10)) == parseInt(JUST.Cache.currentPlayer.PID)
            $this.playerHasWon = $this.roundHasPassed && $this.playerIsLeader
            $this.isCEO = JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn && JUST.Cache.currentPlayer && JUST.Cache.currentPlayer.Round && JUST.Cache.currentPlayer.Round[1] !== "0x0000000000000000000000000000000000000000000000000000000000000000"
            $this.myLink = $this.isCEO ? `${window.location.origin}/${JUST.Bridges.Metamask.web3.eth.defaultAccount}` : `#`
            $this.gracePeriod = false
            // $this.gracePeriod = true
            $this.myLinkid = $this.isCEO ? `${window.location.origin}/${JUST.Cache.currentPlayer.PID.toFixed()}` : `#`
            $this.myLinkName = $this.isCEO ? `${window.location.origin}/${JUST.Bridges.Browser.web3.utils.toAscii(JUST.Cache.currentPlayer.Round[1])}` : `#`
            $this.myLinkName = $this.myLinkName.replace(/ /g,'%20')
        }

        async function rewire() {

            if($this.isCEO) jQuery(".afflink span").text($this.myLinkName)

             // open vanity from ceo box
            jQuery(".buyceo").click(async e => {
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网.")
                jQuery('#vanity').modal()
            })

            // Check for tutorial switch settings
            if(tutorial_mode != "true"){
                jQuery('.tutorial').css({"display": "none"});
                jQuery("#tutorialswitch").prop("checked", false);
            }

             // Teamselect localstorage thingy
            let saved_team = localStorage.getItem("team")
              if(saved_team){
                  if(saved_team == "0"){
                    jQuery("#teamsnek").prop("checked", true);
                }
                if(saved_team == "1"){
                    jQuery("#teamwhale").prop("checked", true);
                }
                if(saved_team == "2"){
                    jQuery("#teambull").prop("checked", true);
                }
                if(saved_team == "3"){
                    jQuery("#teambear").prop("checked", true);
                }
              } else {
                  jQuery("#teamsnek").prop("checked", true);
              }

            if(!$this.roundHasPassed) {
                jQuery("#quotes").addClass("active")
                if(JUST.Bridges.Metamask && JUST.Bridges.Metamask.signedIn){
                    jQuery(".keycount").text(BN(JUST.Cache.currentPlayer.Round[2]).div(1e18).toFixed(4))
                } else {
                    jQuery(".keycount").text("0")

                }
                if($this.timer) $this.timer.Destroy()
                $this.timer = new Countdown(JUST.Cache.currentRound[3], async (data, expired) => {
                    now = (JUST.date().getTime() / 1000)
                    if(Math.floor( JUST.date().getTime() / 1000) > (parseInt(JUST.Cache.currentRound[3]) - 90) && $this.gracePeriod) {

                        $this.gracePeriod = false

                        // pepe
                        function pepe(){
                        $(".animation").animate({bottom: "-30px"}, "slow");
                            $(".animation").animate({left: "100%"}, "slow", function () {
                              $(this).removeAttr('style');
                            });
                        }
                        pepe()

                        // clear timer from stack
                        clearInterval(window.globalTimerObject)

                        $this.refresher()
                    }

                    if(!expired){
                        if($this.gracePeriod){
                            let actualTime = parseDifference(new Date(parseInt(JUST.Cache.currentRound[3]) - 90), JUST.date())
                            jQuery(".headtimer").text(`${(actualTime.hours == "00" ? "" : actualTime.hours + ":") }${actualTime.minutes}:${actualTime.seconds}`)
                        } else {
                            jQuery(".headtimer").text(`${(data.hours == "00" ? "" : data.hours + ":") }${data.minutes}:${data.seconds}`)

                        }

                        jQuery(".boxtimer").text(`${(data.hours == "00" ? "" : data.hours + ":") }${data.minutes}:${data.seconds}`)

                        var timeTotal = parseInt(parseInt(JUST.Cache.currentRound[4]) - parseInt(JUST.Cache.currentRound[4])) + 3600
                        var timeRemaining = parseInt(JUST.Cache.currentRound[3]) - now
                        var timePercentage = 100 - timeRemaining / (timeTotal / 100)

                        //console.log(timeTotal, timeRemaining, Math.floor(timePercentage))

                        jQuery(".progress-bar.boxglow").css('width', `${Math.floor(timePercentage)}%`)

                    } else {
                        jQuery("#quotes").removeClass("active")
                        // refresh dom
                        $this.refresher()
                    }
                })
            }
            if($this.gracePeriod && !this.graceTimer) {

                console.log("execute", parseInt(JUST.Cache.currentRound[3]) + 300)
                new Countdown(parseInt(JUST.Cache.currentRound[3]) + 300, async (data, expired) => {
                    $this.graceTimer = true
                    now = (JUST.date().getTime() / 1000)


                    if(now < (parseInt(JUST.Cache.currentRound[3]) + 300) ){
                        jQuery(".graceTimer").text(`${(data.hours == "00" ? "" : data.hours + ":") }${data.minutes}:${data.seconds}`)
                    } else {
                        $this.gracePeriod = false
                        // clear timer from stack
                        $this.graceTimer = false
                        // refresh dom
                        $this.refresher()
                    }
                })
            }

            await jQuery( ".buyOneTicket" ).unbind()
            await jQuery( "#tixBuy" ).unbind()
            await jQuery( "#tixReinvest" ).unbind()
            await jQuery( "#withdrawEarnings" ).unbind()
            await jQuery( "#ethSpend" ).unbind()
            await jQuery( "#ethReinvest" ).unbind()

            jQuery(".buyOneTicket").click(async e  => {
                if(!JUST.Bridges.Metamask || !JUST.Bridges.Metamask.signedIn) return alertify.alert("Metamask未登录。")
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网。")
                var masternode = window.localStorage.getItem("masternode") ? window.localStorage.getItem("masternode") : "0x0"

                try {
                    let priceQuotation = await JUST.Bridges.Browser.contracts.Fomo3D.read('iWantXKeys', [BN(1050000000000000000)])
                    jQuery('#loading').modal({backdrop: 'static', keyboard: false})
                    let team = $("input[name='teamselect']:checked").val()
                    if(!team) team = 0
                    let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.purchaseKeys(priceQuotation, team)
                    //let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.write("buy", [masternode, 1], {value: priceQuotation})
                    jQuery('#loading').modal('hide')
                    alertify.log(`钥匙购买请求已提交至ETH网络！`)
                    console.log(receipt)
                } catch (e) {
                    console.log(e)
                    alertify.log(`购买请求被取消。`)
                    jQuery('#loading').modal('hide')
                }
            })

            /**
             * Whenever the input of tixToBuy changes..
             */
            jQuery("#tixToBuy").bind('input', getQuote)

            /**
             * When the purchase button is clicked.
             */
            jQuery("#tixBuy").click( async e => {
                if(!JUST.Bridges.Metamask || !JUST.Bridges.Metamask.signedIn) return alertify.alert("Metamask未登录。")
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网。")
                let count = String(jQuery("#tixToBuy").val()).replace("keys", "").replace("key", "").replace("Keys", "").replace("Key", "")
                if(!Number.isInteger(parseInt(count))) return
                var masternode = window.localStorage.getItem("masternode") ? window.localStorage.getItem("masternode") : "0x0"
                count = BN((parseInt(count)) * 1e18)

                try {
                    let priceQuotation = await JUST.Bridges.Browser.contracts.Fomo3D.read('iWantXKeys', count)
                    jQuery('#loading').modal({backdrop: 'static', keyboard: false})
                    let team = $("input[name='teamselect']:checked").val()
                    if(!team) team = 0
                    let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.purchaseKeys(BN(priceQuotation).plus(100).toString(), team)
                    alertify.log(`钥匙购买请求已提交至ETH网络！`)
                    jQuery('#loading').modal('hide')

                    console.log(receipt)
                } catch (e) {
                    alertify.log(`购买请求被取消。`)
                    jQuery('#loading').modal('hide')

                }

            })

            /**
             * When the reinvest button is clicked.
             */
            jQuery("#tixReinvest").click( async e => {
                if(!JUST.Bridges.Metamask || !JUST.Bridges.Metamask.signedIn) return alertify.alert("Metamask未登录。")
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网。")
                let vaultEarnings = BN(JUST.Cache.currentPlayer.Vaults[0]).plus(JUST.Cache.currentPlayer.Vaults[1]).plus(JUST.Cache.currentPlayer.Vaults[2])
                let count = String(jQuery("#tixToBuy").val()).replace("keys", "").replace("key", "").replace("Keys", "").replace("Key", "")
                var masternode = window.localStorage.getItem("masternode") ? window.localStorage.getItem("masternode") : "0x0"
                if(!Number.isInteger(parseInt(count))) return
                count = BN((parseInt(count) ) * 1e18)

                try {
                    let priceQuotation = await JUST.Bridges.Browser.contracts.Fomo3D.read('iWantXKeys', [BN(count)])
                    if(vaultEarnings.isLessThan(BN(priceQuotation))) return alertify.alert(`金库余额不足，需支付${BN(priceQuotation).div(1e18).toFixed(4)}ETH购买${count.div(1e18).toFixed(4)}把钥匙。 你的金库仅有${vaultEarnings.div(1e18).toFixed(4)}ETH。`)
                    jQuery('#loading').modal({backdrop: 'static', keyboard: false})
                    let team = $("input[name='teamselect']:checked").val()
                    if(!team) team = 0
                    let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.purchaseKeys(BN(priceQuotation).plus(100).toString(), team, true)
                    alertify.log(`钥匙购买请求已提交至ETH网络！`)
                    jQuery('#loading').modal('hide')

                    console.log(receipt)
                } catch (e) {
                    console.error(e)
                    alertify.log(`购买请求被取消。`)
                    jQuery('#loading').modal('hide')

                }
            })

            /**
             * When the ICO invest button is pressed
             */
            jQuery("#ethSpend").click( async e => {
                if(!JUST.Bridges.Metamask || !JUST.Bridges.Metamask.signedIn) return alertify.alert("Metamask未登录。.")
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网。")
                let count = String(jQuery("#ethToSpend").val()).replace("ethereum", "").replace("Ethereum", "").replace("eth", "").replace("ETH", "")
                if(!Number.isInteger(parseInt(count))) return
                count = BN(count).multipliedBy(1e18)

                try {
                    let team = $("input[name='teamselect']:checked").val()
                    if(!team) team = 1
                    jQuery('#loading').modal({backdrop: 'static', keyboard: false})
                    let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.purchaseKeys(count.toString(), team)
                    alertify.log(`钥匙购买请求已提交至ETH网络！`)
                    jQuery('#loading').modal('hide')
                    console.log(receipt)
                } catch (e) {
                    alertify.log(`购买请求被取消。`)
                    jQuery('#loading').modal('hide')

                }
            })

            /**
             * When the ICO invest button is pressed
             */
            jQuery("#ethReinvest").click( async e => {
                if(!JUST.Bridges.Metamask || !JUST.Bridges.Metamask.signedIn) return alertify.alert("Metamask未登录。")
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网。")
                let count = String(jQuery("#ethToSpend").val()).replace("ethereum", "").replace("Ethereum", "").replace("eth", "").replace("ETH", "")
                if(!Number.isInteger(parseInt(count))) return
                count = BN(count).multipliedBy(1e18)

                try {
                    let team = $("input[name='teamselect']:checked").val()
                    if(!team) team = 1
                    let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.purchaseKeys(count.toString(), team, true)
                    alertify.log(`钥匙购买请求已提交至ETH网络！`)
                    jQuery('#loading').modal('hide')
                    console.log(receipt)
                } catch (e) {
                    alertify.log(`购买请求被取消。`)
                    jQuery('#loading').modal('hide')

                }
            })

            jQuery("#withdrawEarnings").click(async e => {
                if(!JUST.Bridges.Metamask || !JUST.Bridges.Metamask.signedIn) return alertify.alert("Metamask未登录。")
                let correctNetwork  = await JUST.checkNetwork()
                if(!correctNetwork) return alertify.alert("您所在的网络不正确，请切换至ETH主网。")
                jQuery('#loading').modal({backdrop: 'static', keyboard: false})
                try {
                    let receipt = await JUST.Bridges.Metamask.contracts.Fomo3D.write("withdraw")
                    jQuery('#loading').modal('hide')
                    alertify.log(`提款请求已被提交至ETH网络！`)
                    console.log(receipt)

                } catch(e) {
                    alertify.log(`购买请求被取消。`)
                    jQuery('#loading').modal('hide')
                }
            })


            getQuote()
        }

        async function getQuote(){
            let count = String(jQuery("#tixToBuy").val()).replace("key", "").replace("keys", "").replace("Key", "").replace("Keys", "")
            if(!Number.isInteger(parseInt(count))) return
            count = BN(parseInt(count) * 1e18)

            let priceQuotation = await JUST.Bridges.Browser.contracts.Fomo3D.read('iWantXKeys', count)

            jQuery("#tixQuotation").text(`@ ${BN(priceQuotation).plus(100).div(1e18).toFixed(8)} ETH`)

            console.log(priceQuotation)
        }


        $this.on('update', assemble)
        $this.on('updated', rewire)
        $this.on('before-mount', assemble)
        this.on('unmount', fn => {
            if(window.globalTimerObject && typeof window.globalTimerObject !== "undefined") clearInterval(window.globalTimerObject)
        })


        JUST.UI.on('ui.refresh', () => {
            console.log('refreshing ui')
            $this.refresher()
        } )


        $this.on('mount', function(){

            // wire listeners
            rewire()

            new ClipboardJS('.btn');

          // Teamselection to var
          jQuery('.ticketProcess').click(function(){
            var team = $("input[name='teamselect']:checked").val()
            //console.log(team)
          });

          // Increase ticket amount to buy with buttons
          jQuery('.increment').click(function(){
            let id = this.id

            if(id == 'addOne'){
              var increment = 1
            }
            if(id == 'addTwo'){
              var increment = 2
            }
            if(id == 'addFive'){
              var increment = 5
            }
            if(id == 'addTen'){
              var increment = 10
            }

            if(id == 'addHundred'){
              var increment = 100
            }
            if(jQuery('#tixToBuy').val()){
                ///replace("key", "").replace("keys", "").replace("Key", "").replace("Keys", "")
                var iVal = parseInt(String(jQuery("#tixToBuy").val()).replace("keys", "").replace("key", "").replace("Keys", "").replace("Key", ""))
            }
            else{
                var iVal = 1
            }

            let nVal = iVal + increment

            jQuery("#tixToBuy").val(nVal.toString())

            getQuote()

          });

          // Quote script
          //jQuery(".qTarget").text(memes.global.quoteRoulette[Math.floor(Math.random()*memes.global.quoteRoulette.length)]);

          // Enable popovers
          jQuery(".qbtn").click(function(){
            jQuery('[data-toggle="popover"').popover()
          })





            // save team
            jQuery('.teamselector input').click(function(){
                let thisteam = $(this).attr('id')
                if(thisteam == "teamsnek"){
                    localStorage.setItem('team', '0');
                }
                if(thisteam == "teamwhale"){
                    localStorage.setItem('team', '1');
                }
                if(thisteam == "teambull"){
                    localStorage.setItem('team', '2');
                }
                if(thisteam == "teambear"){
                    localStorage.setItem('team', '3');
                }
            })

            // airdrop modal animation

            airdrop_animate = function(){
                $("#airdrop row col-6").animate({bottom: "-30px"}, "fast", function(){
                    $(this).removeAttr('style');
                });
            }
      })
    </script>
</state-play>

<state-airdrop>
    <!-- airdrop custom modal popup -->
    <div class="container" id="airdrop" style="z-index: 999; display:none;">
        <div class="row">
            <div class="col-6" style="position: fixed; bottom:0; left:25%;">
                <div class="jumbotron jumbotron-adjust jumboshade bg-dark text-light">
                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <p class="lead">空投：你中奖了！</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <p class="font-weight-light string">你从空投池里得到了一大笔ETH</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-parachute-box airdropicon ethglow-its-okay-justo"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /airdrop custom modal popup -->
    <script>
        $this = this
        $this.on('mount', e => {
            console.log('mounted')
        })
    </script>
</state-airdrop>